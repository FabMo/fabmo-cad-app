/*! fabmo.js v1.1.1 */
!function(a,b){document.getElementsByTagName("body");"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.FabMoDashboard=b()}(this,function(){function a(a){if(a instanceof jQuery)a=a.is("input:file")?a[0]:a.find("input:file")[0],file=a.files[0];else if(a instanceof HTMLInputElement)file=a.files[0];else if(a instanceof File||a instanceof Blob)file=a;else{if("string"!=typeof a)throw new Error("Cannot make File object out of "+a);file=new Blob([a],{type:"text/plain"})}return file}function b(b){return{file:a(b)}}function c(b){var c=null;try{c=a(b)}catch(d){}if(c)return{file:c};var e={};for(var f in b)b.hasOwnProperty(f)&&("file"===f?e.file=a(b.file):e[f]=b[f]);return e}var d=function(a){this.version="v1.1.1",this.target=window.parent,this.window=window,this._setOptions(a),this._id=0,this._handlers={},this.status={},this.isReady=!1,this._event_listeners={status:[],job_start:[],job_end:[],change:[],disconnect:[],reconnect:[],video_frame:[]},this._setupMessageListener(),document.onkeyup=function(a){27==a.keyCode&&this.stop()}.bind(this),this.options.defer||this.ready()};d.prototype._setOptions=function(a){a=a||{},this.options={},this.options.defer=a.defer||!1},d.prototype.isPresent=function(){try{return window.self!==window.top}catch(a){return!0}},d.prototype._download=function(a,b,c){function d(a,b){if("download"in l)return l.href=a,l.setAttribute("download",o),l.innerHTML="downloading...",k.body.appendChild(l),setTimeout(function(){l.click(),k.body.removeChild(l),b===!0&&setTimeout(function(){g.URL.revokeObjectURL(l.href)},250)},66),!0;if("undefined"!=typeof safari)return a="data:"+a.replace(/^data:([\w\/\-\+]+)/,h),window.open(a)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=a),!0;var c=k.createElement("iframe");k.body.appendChild(c),b||(a="data:"+a.replace(/^data:([\w\/\-\+]+)/,h)),c.src=a,setTimeout(function(){k.body.removeChild(c)},333)}var e,f,g=window,h="application/octet-stream",i=c||h,j=a,k=document,l=k.createElement("a"),m=function(a){return String(a)},n=g.Blob||g.MozBlob||g.WebKitBlob||m,n=n.call?n.bind(g):Blob,o=b||"download";if(e=j instanceof n?j:new n([j],{type:i}),navigator.msSaveBlob)return navigator.msSaveBlob(e,o);if(g.URL)d(g.URL.createObjectURL(e),!0);else{if("string"==typeof e||e.constructor===m)try{return d("data:"+i+";base64,"+g.btoa(e))}catch(p){return d("data:"+i+","+encodeURIComponent(e))}f=new FileReader,f.onload=function(a){d(this.result)},f.readAsDataURL(e)}return!0},d.prototype._call=function(a,b,c){this.isPresent()?(message={call:a,data:b},c&&(message.id=this._id++,this._handlers[message.id]=c),this.target.postMessage(message,"*")):this._simulateCall(a,b,c)},d.prototype._simulateCall=function(a,b,c){e();var d=document.getElementById("alert-toaster"),g=document.getElementById("alert-text");switch(a){case"submitJob":var h=[];if(b.jobs.forEach(function(a){var b=a.filename||a.file.name;this._download(a.file,b,"text/plain"),h.push(b)}.bind(this)),1===b.jobs.length)var i="Job Submitted: "+b.jobs[0].filename;else var i=b.jobs.length+" Jobs Submitted: "+h.join(",");g.textContent=i,f(d);break;case"runGCode":g.textContent="GCode sent to tool: "+b,f(d);break;case"runSBP":g.textContent="OpenSBP sent to tool: "+b,f(d);break;case"showDRO":g.textContent="DRO Shown.",f(d);break;case"hideDRO":g.textContent="DRO Hidden.",f(e);break;default:g.textContent=a+" called.",f(d)}},d.prototype._on=function(a,b){var c={on:a};b&&this._event_listeners[a].push(b),this.target.postMessage(c,"*")},d.prototype.on=function(a,b){this._on(a,b)},d.prototype._setupMessageListener=function(){this.window.addEventListener("message",function(a){var b=a.data;switch(b.type){case"cb":"id"in b&&b.id in this._handlers&&(cb=this._handlers[b.id],"success"===b.status?cb(null,b.data):cb(b.message,null));break;case"evt":if("id"in b&&b.id in this._event_listeners){listeners=this._event_listeners[b.id];for(i in listeners)listeners[i](b.data)}}}.bind(this))},d.prototype.ready=function(){this._call("ready"),this.isReady=!0},d.prototype.setBusyMessage=function(a){this._call("setBusyMessage",{message:a})},d.prototype.getAppArgs=function(a){this._call("getAppArgs",null,a)},d.prototype.getAppInfo=function(a){this._call("getAppInfo",null,a)},d.prototype.launchApp=function(a,b,c){this._call("launchApp",{id:a,args:b},c)},d.prototype.showDRO=function(a){this._call("showDRO",null,a)},d.prototype.hideDRO=function(a){this._call("hideDRO",null,a)},d.prototype.showModal=function(a,b){var c={ok:a.ok,cancel:a.cancel},d=function(a,d){a&&b(a);var e=c[d]();e?e():b&&b()};a.ok=!!a.ok,a.cancel=!!a.cancel,this._call("openModal",a,d)},d.prototype.hideModal=function(a,b){this._call("closeModal",null,b)},d.prototype.notify=function(a,b,c){this._call("notify",{type:a,message:b},c)},d.prototype.hideFooter=function(a){this._call("hideFooter",null,a)},d.prototype.notification=function(a,b,c){this._call("notification",{type:a,message:b},c)},d.prototype.notify=d.prototype.notification,d.prototype.submitJob=function(a,b,d){var e={jobs:[]};if(a instanceof jQuery){a=a.is("input:file")?obj[0]:a.find("input:file")[0];var f=a.files;if(f.length){a=[];for(var g=0;g<f.length;g++)a.push(f[g])}}else a.length||(a=[a]);for(var g=0;g<a.length;g++)e.jobs.push(c(a[g]));"function"==typeof b&&(d=b,b={}),e.options=b||{},this._call("submitJob",e,d)},d.prototype.updateOrder=function(a,b){this._call("updateOrder",a,b)},d.prototype.resubmitJob=function(a,b){this._call("resubmitJob",a,b)},d.prototype.deleteJob=function(a,b){this._call("deleteJob",a,b)},d.prototype.cancelJob=d.prototype.cancelJob,d.prototype.getJobInfo=function(a,b){this._call("getJobInfo",a,b)},d.prototype.getJobsInQueue=function(a){this._call("getJobsInQueue",null,a)},d.prototype.clearJobQueue=function(a){this._call("clearJobQueue",null,a)},d.prototype.getJobHistory=function(a,b){this._call("getJobHistory",a,b)},d.prototype.runNext=function(a){this._call("runNext",null,a)},d.prototype.pause=function(a){this._call("pause",null,a)},d.prototype.stop=function(a){this._call("stop",null,a)},d.prototype.resume=function(a){this._call("resume",null,a)},d.prototype.manualMoveFixed=function(a,b,c,d){this._call("manualMoveFixed",{axis:a,speed:b,dist:c},d)},d.prototype.manualStart=function(a,b){this._call("manualStart",{axis:a,speed:b},callback)},d.prototype.manualHeartbeat=function(){this._call("manualHeartbeat",{},callback)},d.prototype.manualStop=function(){this._call("manualStop",{},callback)},d.prototype.getApps=function(a){this._call("getApps",null,a)},d.prototype.submitApp=function(a,c,d){var e={apps:[]};if(a instanceof jQuery){a=a.is("input:file")?a[0]:a.find("input:file")[0];var f=a.files;if(f.length){a=[];for(var g=0;g<f.length;g++)a.push(f[g])}}else a.length||(a=[a]);for(var g=0;g<a.length;g++)e.apps.push(b(a[g]));"function"==typeof c&&(d=c,c={}),e.options=c||{},this._call("submitApp",e,d)},d.prototype.getConfig=function(a){this._call("getConfig",null,a)},d.prototype.setConfig=function(a,b){this._call("setConfig",a,b)},d.prototype.deleteApp=function(a,b){this._call("deleteApp",a,b)},d.prototype.runGCode=function(a,b){this._call("runGCode",a,b)},d.prototype.runSBP=function(a,b){this._call("runSBP",a,b)},d.prototype.connectToWifi=function(a,b,c){this._call("connectToWifi",{ssid:a,key:b},c)},d.prototype.disconnectFromWifi=function(a){this._call("disconnectFromWifi",null,a)},d.prototype.forgetWifi=function(a,b,c){this._call("forgetWifi",{ssid:a},c)},d.prototype.enableWifi=function(a){this._call("enableWifi",null,a)},d.prototype.disableWifi=function(a){this._call("disableWifi",null,a)},d.prototype.enableWifiHotspot=function(a){this._call("enableWifiHotspot",null,a)},d.prototype.disableWifiHotspot=function(a){this._call("disableWifiHotspot",null,a)},d.prototype.getWifiNetworks=function(a){this._call("getWifiNetworks",null,a)},d.prototype.getWifiNetworkHistory=function(a){this._call("getWifiNetworkHistory",null,a)},d.prototype.getNetworkIdentity=function(a){this._call("getNetworkIdentity",null,a)},d.prototype.setNetworkIdentity=function(a,b){this._call("setNetworkIdentity",a,b)},d.prototype.isOnline=function(a){this._call("isOnline",null,a)},d.prototype.getMacros=function(a){this._call("getMacros",null,a)},d.prototype.runMacro=function(a,b){this._call("runMacro",a,b)},d.prototype.updateMacro=function(a,b,c){this._call("updateMacro",{id:a,macro:b},c)},d.prototype.requestStatus=function(a){this._call("requestStatus",null,a)},d.prototype.startVideoStreaming=function(a){this._call("startVideoStreaming",null,a)},d.prototype.onVideoFrame=function(a){this.on("video_frame",function(b){imageObj=new Image,imageObj.src="data:image/jpeg;base64,"+b,imageObj.onload=function(){a(imageObj)}})},d.prototype.deleteMacro=function(a,b){this._call("deleteMacro",a,b)},d.prototype.getAppConfig=function(a){this._call("getAppConfig",null,a)},d.prototype.setAppConfig=function(a,b){this._call("setAppConfig",a,b)},d.prototype.getVersion=function(a){this._call("getVersion",null,a)},d.prototype.navigate=function(a,b,c){var d=window.location.href;this._call("navigate",{path:d.substr(0,d.lastIndexOf("/"))+"/",url:a,options:b||{}},c)},d.prototype.getCurrentUser=function(a){this._call("getCurrentUser",null,a)},d.prototype.addUser=function(a,b){this._call("addUser",a,b)},d.prototype.modifyUser=function(a,b){this._call("modifyUser",a,b)},d.prototype.deleteUser=function(a,b){this._call("deleteUser",a,b)},d.prototype.getUsers=function(a){this._call("getUsers",null,a)};var e=function(){var a=document.createElement("div");a.setAttribute("id","alert-toaster"),a.style.cssText="position:fixed; visibility:hidden; margin: auto; top: 20px; right: 20px; width: 250px; height: 60px; background-color: #F3F3F3; border-radius: 3px; z-index: 1005; box-shadow: 4px 4px 7px -2px rgba(0,0,0,0.75);",a.innerHTML="<span id='alert-text' style= 'position:absolute; margin: auto; top: 0; right: 0; bottom: 0; left: 0; height: 20px; width: 250px; text-align: center;'></span>",document.body.appendChild(a)},f=function(a){a.style.visibility="visible",setTimeout(function(){document.body.removeChild(a)},1e3)};return d});